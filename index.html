<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="D3 hw4 : ">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <script src="https://d3js.org/d3.v3.js"></script>
    <title>D3 hw4</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/harry1010/D3_HW4">View on GitHub</a>

          <h1 id="project_title">D3 hw4</h1>
          <h2 id="project_tagline"></h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/harry1010/D3_HW4/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/harry1010/D3_HW4/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
        <h3>練習一</h3>
        <svg id="invoice" width="600" height="250"></svg>
        <script>
        d3.json("invoice-taipei.json",function(dataSet) {
         var body = d3.select("body");
         var count = 0;
         for(var i=0; i < dataSet.length; i++) {
            if(parseInt(dataSet[i].amount) > 1000000000 && dataSet[i].date === "2016/8/1" && dataSet[i].cid ==="A") {
              body.select("#invoice").append("text").attr({
                x: 0,
                y: 20 + 20 * count,
                "font-size": 12
              }).text(dataSet[i].industry);
                
              d3.select("#invoice")
              .append("rect")
              .attr({
                 x: 200,
                 y: 10 + 20 * count,
                 width: dataSet[i].amount / 100000000,
                 height: 10,
                 fill: "blue"
              });
              count++;
            }
            
         }
        });
        </script>
        <h3>練習二</h3>
        <div id="grade" height= "800" width="600"></div>
<script>
    var arr = [99, 23, 77, 68, 55, 87];
    var grade = d3.select("#grade");
      for(var i=0; i<arr.length; i++) {
        if(arr[i]<60){
            grade.append("div").text(arr[i]).style({color: "red"});
        } else if(arr[i] >= 60 && arr[i] < 80) {
            grade.append("div").text(arr[i]).style({color: "blue"});
        } else {
            grade.append("div").text(arr[i]).style({color: "green"});
        }
      }
</script>
        
        
        <h3>練習三</h3>
        <input type="button" value="+" onclick="update();"> <input type="button" value="-" onclick="exited();">
        <br/>
        <svg id="ppap" width ="900" height="200"></svg>
        
        
<script>
    var w = 900;
    var h = 200;
    var p = 50;
    var array = [56,77,36,82,16,96];
    bind(array);
    render();
    bind2(array);
    render2();
    function random(n, m)
    {
        return Math.ceil( Math.random()*(m-n)+n )
    }
    
    function update(){
        var num = random(10,100);
        array.push(num);
        bind(array);
        render();
        bind2(array);
        render2();
    }
    
    function exited(){
        array.pop();
        bind(array);
        render();
        bind2(array);
        render2();
    }
    
    function bind(data)
    {
        var selections = d3.select("#ppap").selectAll("rect").data(data);
        selections.enter().append("rect");
        selections.exit().remove();
    }
    
    function render()
    {
        d3.selectAll("#ppap rect").attr({
            x:function(d,i){
               return p+i*45; 
            },
            y:function(d){
               return h-p-d; 
            },
            width:40,
            height:function(d){
               return d 
            },
            fill:function(d){
                if(d<60)
                    return "red";
                else 
                    return "lightgreen";
            }
        })
        
        d3.selectAll("rect").text(function(d){return d;})
        d3.select("#ppap").append("text")
    }
    
    function bind2(data)
    {
        var selections = d3.select("#ppap").selectAll("text").data(data);
        selections.enter().append("text");
        selections.exit().remove();
    }
    
    function render2()
    {
        d3.selectAll("#ppap text").attr({
            x:function(d,i){
               return p+5+i*46; 
            },
            y:function(d){
               return h-p+20;
            },
            fill:function(d){
                return "black";
            }
        }).text(function(d){return d;})
        
    }
</script>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">D3 hw4 maintained by <a href="https://github.com/harry1010">harry1010</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
